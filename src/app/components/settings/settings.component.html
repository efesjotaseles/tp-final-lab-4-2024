<div class="settings-container">
  <h2 class="mb-4">Configuración de cuenta</h2>
  
  

  <!-- Modificar nombre -->
  <div class="section mb-4"> 
    <button
      class="btn btn-secondary w-100 text-start mb-2"
      type="button"
      data-bs-toggle="collapse"
      data-bs-target="#nameSection"
      aria-expanded="false"
      aria-controls="nameSection"
    >
      Modificar nombre
    </button>
    <div class="collapse" id="nameSection">
      <form [formGroup]="nameForm" (ngSubmit)="updateName()" class="mt-3">
        <div class="form-group">
          <label for="name">Nombre:</label>
          <input
            type="text"
            id="name"
            class="form-control"
            formControlName="name"
            [ngClass]="{'is-invalid': nameForm.get('name')?.invalid && nameForm.get('name')?.touched}"
          />
          <div *ngIf="nameForm.get('name')?.invalid && nameForm.get('name')?.touched" class="invalid-feedback">
            <span *ngIf="nameForm.get('name')?.errors?.['required']">El nombre es obligatorio.</span>
            <span *ngIf="nameForm.get('name')?.errors?.['pattern']">El nombre solo debe contener letras y espacios.</span>
          </div>
        </div>
        <button type="submit" class="btn btn-primary mt-3" [disabled]="nameForm.invalid">Guardar</button>
      </form>
    </div>
  </div>

  <!-- Modificar apellido -->
<div class="section mb-4">
  <button
    class="btn btn-secondary w-100 text-start mb-2"
    type="button"
    data-bs-toggle="collapse"
    data-bs-target="#lastNameSection"
    aria-expanded="false"
    aria-controls="lastNameSection"
  >
    Modificar apellido
  </button>
  <div class="collapse" id="lastNameSection">
    <form [formGroup]="lastNameForm" (ngSubmit)="updateLastName()" class="mt-3">
      <div class="form-group">
        <label for="lastName">Apellido:</label>
        <input
          type="text"
          id="lastName"
          class="form-control"
          formControlName="lastName"
          [ngClass]="{'is-invalid': lastNameForm.get('lastName')?.invalid && lastNameForm.get('lastName')?.touched}"
        />
        <div *ngIf="lastNameForm.get('lastName')?.invalid && lastNameForm.get('lastName')?.touched" class="invalid-feedback">
          <span *ngIf="lastNameForm.get('lastName')?.errors?.['required']">El apellido es obligatorio.</span>
          <span *ngIf="lastNameForm.get('lastName')?.errors?.['pattern']">El apellido solo debe contener letras y espacios.</span>
        </div>
      </div>
      <button type="submit" class="btn btn-primary mt-3" [disabled]="lastNameForm.invalid">Guardar</button>
    </form>
  </div>
</div>


  <!-- Modificar email -->
  <div class="section mb-4"> 
    <button
      class="btn btn-secondary w-100 text-start mb-2"
      type="button"
      data-bs-toggle="collapse"
      data-bs-target="#emailSection"
      aria-expanded="false"
      aria-controls="emailSection"
    >
      Modificar email
    </button>
    <div class="collapse" id="emailSection">
      <form [formGroup]="emailForm" (ngSubmit)="updateEmail()" class="mt-3">
        <div class="form-group">
          <label for="email">Email:</label>
          <input
            type="email"
            id="email"
            class="form-control"
            formControlName="email"
            [ngClass]="{'is-invalid': emailForm.get('email')?.invalid && emailForm.get('email')?.touched}"
          />
          <div *ngIf="emailForm.get('email')?.invalid && emailForm.get('email')?.touched" class="invalid-feedback">
            <span *ngIf="emailForm.get('email')?.errors?.['required']">El email es obligatorio.</span>
            <span *ngIf="emailForm.get('email')?.errors?.['email']">Formato de email inválido.</span>
            <span *ngIf="emailForm.get('email')?.errors?.['emailExists']">El email ya está registrado.</span>
          </div>
        </div>
        <button type="submit" class="btn btn-primary mt-3" [disabled]="emailForm.invalid">Guardar</button>
      </form>
    </div>
  </div>

  <!-- Cambiar contraseña -->
  <div class="section mb-4"> 
    <button
      class="btn btn-secondary w-100 text-start mb-2"
      type="button"
      data-bs-toggle="collapse"
      data-bs-target="#passwordSection"
      aria-expanded="false"
      aria-controls="passwordSection"
    >
      Cambiar contraseña
    </button>
    <div class="collapse" id="passwordSection">
      <form [formGroup]="passwordForm" (ngSubmit)="updatePassword()" class="mt-3">
        <div class="form-group">
          <label for="currentPassword">Contraseña actual:</label>
          <input
            type="password"
            id="currentPassword"
            class="form-control"
            formControlName="currentPassword"
            [ngClass]="{'is-invalid': passwordForm.get('currentPassword')?.invalid && passwordForm.get('currentPassword')?.touched}"
          />
          <div *ngIf="passwordForm.get('currentPassword')?.invalid && passwordForm.get('currentPassword')?.touched" class="invalid-feedback">
            <span *ngIf="passwordForm.get('currentPassword')?.errors?.['required']">La contraseña actual es obligatoria.</span>
            <span *ngIf="passwordForm.get('currentPassword')?.errors?.['incorrectPassword']">La contraseña actual no coincide.</span>
          </div>
        </div>
        <div class="form-group">
          <label for="password">Nueva contraseña:</label>
          <input
            type="password"
            id="password"
            class="form-control"
            formControlName="password"
            [ngClass]="{'is-invalid': passwordForm.get('password')?.invalid && passwordForm.get('password')?.touched}"
          />
          <div *ngIf="passwordForm.get('password')?.invalid && passwordForm.get('password')?.touched" class="invalid-feedback">
            <span *ngIf="passwordForm.get('password')?.errors?.['required']">La nueva contraseña es obligatoria.</span>
            <span *ngIf="passwordForm.get('password')?.errors?.['minlength']">Debe tener al menos 4 caracteres.</span>
          </div>
        </div>
        <button type="submit" class="btn btn-primary mt-3" [disabled]="passwordForm.invalid">Guardar</button>
      </form>
    </div>
  </div>

  <div *ngIf="message" [ngClass]="{'alert alert-success': success, 'alert alert-danger': !success}" class="mt-3 position-fixed bottom-0 start-50 translate-middle-x mb-4">
    {{ message }}
  </div>
</div>
